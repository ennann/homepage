---
import { getLangFromUrl, useTranslations } from "../i18n/utils";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<section class="py-20 px-4 max-w-4xl mx-auto flex flex-col md:flex-row items-center gap-12">
    <!-- Interactive Avatar Module -->
    <div id="avatar-container" class="relative w-52 h-52 rounded-full overflow-hidden shrink-0 shadow-2xl cursor-pointer group border-4 border-white/50">
        <!-- Static Background -->
        <div class="absolute inset-0 bg-[url('/bg.png')] bg-cover bg-center transition-transform duration-700 group-hover:scale-105"></div>

        <!-- Dynamic Foreground (Person) -->
        <div id="avatar-person" class="absolute inset-0 bg-[url('/person.png')] bg-cover bg-center transition-transform duration-300 ease-out origin-bottom" style="transform: scale(0.82) translate(0, 4px);">
        </div>

        <!-- Inner Shadow/Highlight for depth -->
        <div class="absolute inset-0 rounded-full shadow-[inset_0_0_20px_rgba(0,0,0,0.2)] pointer-events-none"></div>
    </div>

    <!-- Text Content -->
    <div class="text-left flex-1">
        <h1 class="text-5xl font-bold mb-6 bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-violet-600 leading-tight">
            {t("hero.title")}
        </h1>
        <p class="text-xl text-gray-600 mb-8 font-medium">
            {t("hero.subtitle")}
        </p>
        <p class="text-lg text-gray-500 mb-10 max-w-2xl">
            {t("hero.desc")}
        </p>
        <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-gray-100 text-gray-600 text-sm font-medium mb-6">ğŸ“ Hangzhou, China ğŸ‡¨ğŸ‡³</div>
    </div>
</section>

<script>
    const container = document.getElementById("avatar-container");
    const person = document.getElementById("avatar-person");

    if (container && person) {
        container.addEventListener("mousemove", (e) => {
            const rect = container.getBoundingClientRect();
            const x = e.clientX - rect.left; // x position within the element.
            const y = e.clientY - rect.top; // y position within the element.

            const centerX = rect.width / 2;
            const centerY = rect.height / 2;

            // Calculate distance from center (-1 to 1)
            const moveX = (x - centerX) / centerX;
            const moveY = (y - centerY) / centerY;

            // Move person slightly following the mouse to create a 3D looking effect (Opposite direction)
            const intensity = 5; // Reduced intensity
            // Invert direction (-moveX, -moveY) and maintain the translate-y-1 offset (4px)
            person.style.transform = `scale(0.82) translate(${-moveX * intensity}px, ${-moveY * intensity + 4}px)`;
        });

        container.addEventListener("mouseleave", () => {
            person.style.transform = "scale(0.82) translate(0, 4px)";
        });
    }
</script>
