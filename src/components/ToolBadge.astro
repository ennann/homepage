---
interface Props {
    name: string;
    startDate: string; // YYYY-MM-DD
    logo?: string;
}

const { name, startDate } = Astro.props;

const start = new Date(startDate);
const now = new Date();
const diffTime = Math.abs(now.getTime() - start.getTime());
const days = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

// Tool color mapping
const getToolColor = (toolName: string) => {
    const colors: Record<string, string> = {
        ChatGPT: "bg-[#10A37F]", // OpenAI Green
        Claude: "bg-[#D97757]", // Anthropic Clay/Orange
        Gemini: "bg-[#4E88D4]", // Google Blue
        Copilot: "bg-[#000000]", // Copilot Black (often used for GitHub)
        Cursor: "bg-[#000000]", // Cursor Black
        Trae: "bg-[#3B82F6]", // Generic Blue for Trae
    };
    return colors[toolName] || "bg-gray-600";
};

const toolBg = getToolColor(name);

// Tool Logo Paths (SVG d attribute)
const getToolLogo = (toolName: string) => {
    const logos: Record<string, string> = {
        ChatGPT:
            "M22.2819 9.8211a5.9847 5.9847 0 0 0-.5157-4.9108 6.0462 6.0462 0 0 0-6.5098-2.9A6.0651 6.0651 0 0 0 4.9807 4.1818a5.9847 5.9847 0 0 0-3.9977 2.9 6.0462 6.0462 0 0 0 .7427 7.0966 5.98 5.98 0 0 0 .511 4.9107 6.051 6.051 0 0 0 6.5146 2.9001A5.9847 5.9847 0 0 0 13.2599 24a6.0557 6.0557 0 0 0 5.7718-4.2058 5.9894 5.9894 0 0 0 3.9977-2.9001 6.0557 6.0557 0 0 0-.7475-7.0729zm-9.022 12.6081a4.4755 4.4755 0 0 1-2.8764-1.0408l.1419-.0804 1.6426-1.6426a.3323.3323 0 0 0 .0213-.0213l.0095-.0095a.317.317 0 0 0 .0166-.0166c.0047-.0047.0118-.0071.0142-.0118a.376.376 0 0 0 .0166-.0166l2.9262-1.6875a1.8738 1.8738 0 0 1 2.1089.0949 1.8738 1.8738 0 0 1 .7807 1.9667l-.719 4.182a4.4992 4.4992 0 0 1-3.9355 2.2835zm-3.2084-3.9977a1.8738 1.8738 0 0 1-.2962-2.1089 1.8738 1.8738 0 0 1 1.7824-1.1996l4.2532-.0047a.3323.3323 0 0 0 .0213 0h.0142a.317.317 0 0 0 .0166 0c.0047 0 .0071 0 .0118 0a.376.376 0 0 0 .0166 0l3.377-.0047a4.4992 4.4992 0 0 1-1.652 3.7032l-3.5288 2.0235a4.4992 4.4992 0 0 1-3.9882-2.4088zm-1.2416-5.767c-.0047-.0047-.0071-.0118-.0118-.0142a.376.376 0 0 0-.0166-.0166l-2.9262-1.6875a1.8738 1.8738 0 0 1-2.1089-.0949 1.8738 1.8738 0 0 1-.7807-1.9667l.719-4.182a4.4992 4.4992 0 0 1 3.9308-2.2835 4.4755 4.4755 0 0 1 2.8716 1.0408l-1.6378 1.633a.3323.3323 0 0 0-.0213.0213l-.0095.0095a.317.317 0 0 0-.0166.0166zm-2.4974.1329a1.8738 1.8738 0 0 1 .2962 2.1089 1.8738 1.8738 0 0 1-1.7824 1.1996l-4.2532.0047a.3323.3323 0 0 0-.0213 0h-.0142a.317.317 0 0 0-.0166 0c-.0047 0-.0071 0-.0118 0a.376.376 0 0 0-.0166 0l-3.377.0047a4.4992 4.4992 0 0 1 1.652-3.7032l3.5288-2.0235a4.4992 4.4992 0 0 1 3.9882 2.4088zm4.3812 2.293a1.8738 1.8738 0 0 1 1.8156.8838 1.8738 1.8738 0 0 1-.2962 2.1089l-3.0685 3.0685a4.4992 4.4992 0 0 1-4.0546 1.3743l4.0499-2.3234a.3323.3323 0 0 0 .0213-.0118l.0095-.0095a.317.317 0 0 0 .0166-.0095c.0047-.0024.0118-.0047.0142-.0095a.376.376 0 0 0 .0166-.0095l2.9262-1.6875a4.4992 4.4992 0 0 1-1.449-3.3747zm1.6426-3.9835a4.4992 4.4992 0 0 1 4.0546-1.3743l-4.0499 2.3234a.3323.3323 0 0 0-.0213.0118l-.0095.0095a.317.317 0 0 0-.0166.0095c-.0047.0024-.0118.0047-.0142.0095a.376.376 0 0 0-.0166.0095l-2.9262 1.6875a4.4992 4.4992 0 0 1 1.449 3.3747 1.8738 1.8738 0 0 1-1.8156-.8838 1.8738 1.8738 0 0 1 .2962-2.1089z",
        Claude: "M10.604 3.127 8.844 6.262l-.153.053-.085-.053v-2.152l-.032-.525-.048-1.791-.065-1.554-.08-1.505-.081-.38L7.832 0l-.234.036-.214.32.04.455.069 1.009.105 1.513.064 1.097.17 1.626v.259l-.105.036-.065-.089-.064-.068-1.062-1.566-1.121-1.695-.646-.887-.327-.48-.306-.243-.67-.104-.48.435.04.585.04.15.456.593.981 1.267 1.218 1.654.202.242-.068.097-.049.012-.181-.109-1.626-.9-1.655-.96-.686-.428-.411-.113a2 2 0 0 1-.484-.068l-.674.496L0 4.446l.089.662.242.279.94.411 1.48.666 2.014 1.033.597.302.553.162.17.06h-.097v.085l-1.134.157-1.392.154-1.792.052-.504.25-.605.497-.327.387.186.319.456-.045.294-.19 1.23-.37 1.93-.243 1.29h-.16l.161-.868.654-1.372 1.097-.545.484-.601.565-.287.363h.686l.751.505.775-.226.895-.707.759-.585 1.13-.839.904-.524.072.048-.012.125-.403 1.897-.186 1.024-.21 1.223.258.553.263.06.536-.218.323-1.307.307-1.533.54-2.284.02-.028.04.032.098 1.029.024.44h1.077l.15 2.005.346.525.424.315.323-.053.411-.807-.863-3.631-.218-.872h.073v-.12l.71.726 1.202 1.331 1.55 1.667.383.084.302-.214-.032-.226-1.101-1.464-.497-.565-1.077-1.28h.113v-.084l.432.295 2.34 1.557.718.08.234-.112.141-.404-.08-.444-1.28-.911-1.44-.94-1.291-.759.053-.093 4.821-.448.246-.21.186-.484-.307-.403-.496-.214-.98.214-1.28.258-1.016.21-1.263.19-.42.112-.028-.008.012-.092 1.307.953 1.957-1.448 1.227-1.146.109-.274-.247-.477-.44.045-.39.266-2.018 1.586-1.25.956-.723.617-.105-.004h-.036l-4.212",
        Gemini: "M23 2.999a9.05 9.05 0 0 1-2.588.71A4.516 4.516 0 0 0 15.82 0h-7.64a4.516 4.516 0 0 0-4.592 4.509 9.05 9.05 0 0 1-2.588-.71A11.002 11.002 0 0 0 0 11c0 6.075 4.925 11 11 11s11-4.925 11-11c0-3.95-2.096-7.42-5-9.001zM11 19.5c-4.687 0-8.5-3.813-8.5-8.5S6.313 2.5 11 2.5s8.5 3.813 8.5 8.5-3.813 8.5-8.5 8.5z",
        Copilot:
            "M4 18v-5.5c0 -.667 .167 -1.333 .5 -2 M12 7.5c0 -1 -.01 -4.07 -4 -3.5c-3.5 .5 -4 2.5 -4 3.5c0 1.5 0 4 3 4c4 0 5 -2.5 5 -4z M4 12c-1.333 .667 -2 1.333 -2 2c0 1 0 3 1.5 4c3 2 6.5 3 8.5 3s5.499 -1 8.5 -3c1.5 -1 1.5 -3 1.5 -4c0 -.667 -.667 -1.333 -2 -2 M20 18v-5.5c0 -.667 -.167 -1.333 -.5 -2",
        Cursor: "M5.52 19.08L4 21l6.5-1.5L12 18l1.5 1.5L20 21l-1.52-1.92L21 16l-9-9-9 9 2.52 3.08z", // Generic cursor arrow placeholder
        Trae: "M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 18a8 8 0 1 1 8-8 8 8 0 0 1-8 8zm-2-9h4v2h-4zm0-4h4v2h-4z", // Simple robot face placeholder
    };
    return logos[toolName] || "";
};

const logoPath = getToolLogo(name);

// SVG configuration
const size = 200;
const center = size / 2;
const radius = 70;
const textRadius = 84;
---

<div class="relative w-36 h-36 flex items-center justify-center shrink-0 group perspective-500">
    <!-- Shadow/Lift Container -->
    <div class="relative w-full h-full transition-transform duration-500 group-hover:scale-105 group-hover:-translate-y-2 group-hover:rotate-x-6">
        <!-- Drop Shadow -->
        <div class="absolute inset-2 rounded-full shadow-[0_15px_30px_-10px_rgba(0,0,0,0.4)] transition-all duration-500 group-hover:shadow-[0_25px_50px_-12px_rgba(0,0,0,0.6)]"></div>

        <!-- Main Badge Body -->
        <div class="absolute inset-0 rounded-full bg-[#F0EFE9] border-[6px] border-[#4A4A4A] shadow-[inset_0_0_0_1px_rgba(255,255,255,0.5)] flex items-center justify-center overflow-hidden">
            <!-- Curved Text on Outer Ring -->
            <svg viewBox={`0 0 ${size} ${size}`} class="absolute inset-0 w-full h-full pointer-events-none z-10">
                <defs>
                    <path id={`curve-top-${name}`} d={`M ${center - textRadius},${center} A ${textRadius},${textRadius} 0 1,1 ${center + textRadius},${center}`}></path>
                    <path id={`curve-bottom-${name}`} d={`M ${center - textRadius},${center} A ${textRadius},${textRadius} 0 0,0 ${center + textRadius},${center}`}></path>
                </defs>

                <text class="text-[12px] font-black tracking-[0.15em] uppercase fill-[#4A4A4A]" style="text-shadow: 0 1px 0 rgba(255,255,255,0.5);">
                    <textPath href={`#curve-top-${name}`} startOffset="50%" text-anchor="middle">
                        Joined {name}
                    </textPath>
                </text>

                <text class="text-[12px] font-black tracking-[0.15em] uppercase fill-[#4A4A4A]" style="text-shadow: 0 1px 0 rgba(255,255,255,0.5);">
                    <textPath href={`#curve-bottom-${name}`} startOffset="50%" text-anchor="middle"> Days Ago </textPath>
                </text>
            </svg>

            <!-- Inner Colored Circle -->
            <div class={`relative w-[68%] h-[68%] rounded-full ${toolBg} border-[4px] border-[#4A4A4A] shadow-[inset_0_4px_8px_rgba(0,0,0,0.2)] flex items-center justify-center overflow-hidden`}>
                <!-- Inner Highlight/Shine -->
                <div class="absolute inset-0 rounded-full bg-gradient-to-tr from-transparent via-white/20 to-transparent opacity-80 pointer-events-none z-20"></div>

                <!-- Logo SVG -->
                {
                    logoPath ? (
                        <svg viewBox="0 0 24 24" class="w-1/2 h-1/2 fill-white drop-shadow-md z-10 opacity-30 absolute">
                            <path d={logoPath} />
                        </svg>
                    ) : (
                        <span class="absolute text-6xl font-black text-white/10 select-none">{name.slice(0, 1)}</span>
                    )
                }

                <!-- Number -->
                <span class="text-3xl font-black text-white drop-shadow-md z-30 relative">{days}</span>
            </div>
        </div>

        <!-- Specular Highlight on Outer Ring -->
        <div class="absolute inset-0 rounded-full bg-gradient-to-tr from-white/40 via-transparent to-transparent opacity-50 pointer-events-none rounded-full"></div>
    </div>
</div>

<style>
    .perspective-500 {
        perspective: 500px;
    }
</style>
